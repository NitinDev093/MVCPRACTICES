
@{
    ViewBag.Title = "UploadFile";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container mt-4">
    <div class="row">
    <div id="showHideAlert" class="alert alert-warning alert-dismissible fade show col-lg-8" role="alert">
        <strong id="alertType"></strong> <p id="alert"></p>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    </div>
    <div class="d-flex flex-column">
        <label><strong><small>Upload Excel File</small></strong></label>
        <form id="uploadForm">
            <div class="row">
                <div class="col-lg-3">
                    <input type="file" id="excelFile" name="excelFile" class="form-control form-control-sm mb-3" accept=".xlsx,.xls" />
                </div>
                <div class="col-lg-4">
                    <button type="button" onclick="uploadExcelFile()" id="btnUpload" class="btn btn-primary btn-sm">Upload</button>
                    <button type="button" id="btnDownloadTemplate" class="btn btn-primary btn-sm">Downlpad Template</button>
                </div>

            </div>
        </form>
    </div>
    <div id="message" class="mt-3"></div>

</div>


<script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $("#showHideAlert").hide();
        $("#btnDownloadTemplate").click(function () {
            window.location.href = "/BulkUpload/DownloadTemplate";
        });

    });

    function uploadExcelFile() {
        var file = $("#excelFile")[0].files[0];

        if (!file) {
            $("#showHideAlert").show();
            $("#alertType").html("Warning!")
            $("#alert").html("Please select a file in order to uplaod the Employee Details.");
            return;
        }

        var formData = new FormData();
        formData.append("excelFile", file);

        $.ajax({
            url: '/BulkUpload/UploadExcel', 
            type: 'POST',
            data: formData,
            contentType: false,
            processData: false,
            success: function (response) {
                $("#message").html(`<div class="alert alert-success">${response.message}</div>`);
            },
            error: function (err) {
                $("#message").html(`<div class="alert alert-danger">Error: ${err.responseText}</div>`);
            }
        });
    }
</script>
